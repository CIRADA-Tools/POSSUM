import numpy as np
import healpy as hp

src_list = {
'M83': [314.576424, 31.954887],
'PSZ1 G108.18-11.53': [108.186553, -11.533652],
'EMU': [340.950564, -42.855088],
'SN1006': [327., 14.7],
}
'''
src_list = { ## 'Srcname': [Gal_lon, Gal_lat] in degrees
'J022915+085125': [159.7125, -46.9097],
'J083930-240723': [-112.8565, 10.5233],
'J084600-261054': [249.7139, 10.4645],
'J084701-233701': [-112.2235, 12.2030],
'J090015-281758': [-106.5862, 11.6219],
'J091145-301305': [-103.4271, 12.2686],
'J092410-290606': [-102.3879, 15.0088],
'J093349-302700': [-99.8713, 15.5546],
'J093544-322845': [-98.1035, 14.3848],
'J094750-371528': [-92.9055, 12.5284],
'J094808-344010': [-94.6083, 14.5188],
'J111857+123442': [-117.7216, 63.9173],
'J154936+183500': [30.8284, 48.2929],
'J162706-091705': [5.8042, 26.3417],
'J163927-124139': [4.7810, 21.8767],
'J170934-172853': [5.1147, 13.1808],
'J190255+315942': [63.0288, 11.7569],
'J220205+394913': [90.9624, -12.3144],
'J220927+415834': [93.4244, -11.4303],
'J224412+405715': [98.4955, -15.8035],
'J224549+394122': [98.1337, -17.0577],
'J234033+133300': [97.7984, 45.8338],
'J235728+230226': [107.0862, -38.1651],
}
'''

## Load in the data
data = hp.read_map('2015_phi_map.fits')
data_err = hp.read_map('2015_phi_err_map.fits')

for src in src_list:
   pix_no = hp.ang2pix(128, src_list[src][0], src_list[src][1], lonlat=True)
   fd = data[pix_no]
   fde = data_err[pix_no]
   print(src+'\t%.2f' % fd + '\t%.2f' % fde)


